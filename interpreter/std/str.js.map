{"version":3,"sources":["../../../../src/main/interpreter/std/str.js"],"names":["StringClass","name","Types","String","superClass","Object","properties","push","Formal","functions","Function","NativeExpression","context","self","Bool","rhs","store","get","environment","find","lhs","result","Obj","create","type","set","call","FunctionCall","Reference","Evaluator","evaluate","value","Int","index","charAt","length","s","search","startsWith","endsWith","indexOf","toUpperCase","toLowerCase","start","substring","end","trim","oldSub","newSub","replace","Class"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;;;;;IAEaA,W,WAAAA,W;;;AAET,2BAAc;AAAA;;AAAA;;AAGV,cAAKC,IAAL,GAAYC,aAAMC,MAAlB;;AAEA,cAAKC,UAAL,GAAkBF,aAAMG,MAAxB;;AAEA,cAAKC,UAAL,CAAgBC,IAAhB,CAAqB,IAAIC,cAAJ,CAAW,OAAX,EAAoB,QAApB,CAArB;;AAEA,cAAKC,SAAL,CAAeF,IAAf,CAAoB,IAAIG,cAAJ,CAAa,UAAb,EAAyB,EAAzB,EAA6BR,aAAMC,MAAnC,EAChB,IAAIQ,kCAAJ,CAAqB,UAACC,OAAD,EAAa;AAC9B,mBAAOA,QAAQC,IAAf;AACH,SAFD,CADgB,EAGZ,IAHY,CAApB;;AAKA,cAAKJ,SAAL,CAAeF,IAAf,CAAoB,IAAIG,cAAJ,CAAa,IAAb,EAAmB,CAAC,IAAIF,cAAJ,CAAW,KAAX,EAAkBN,aAAMG,MAAxB,CAAD,CAAnB,EAAsDH,aAAMY,IAA5D,EAChB,IAAIH,kCAAJ,CAAqB,UAACC,OAAD,EAAa;AAC9B,gBAAIG,MAAMH,QAAQI,KAAR,CAAcC,GAAd,CAAkBL,QAAQM,WAAR,CAAoBC,IAApB,CAAyB,KAAzB,CAAlB,CAAV;AACA,gBAAIC,MAAMR,QAAQC,IAAlB;;AAEA,gBAAIQ,SAASC,YAAIC,MAAJ,CAAWX,OAAX,EAAoBV,aAAMY,IAA1B,CAAb;;AAEA,gBAAIC,IAAIS,IAAJ,KAAatB,aAAMC,MAAvB,EAA+B;AAC3BkB,uBAAOI,GAAP,CAAW,OAAX,EAAoB,KAApB;AACH,aAFD,MAEO;AACHJ,uBAAOI,GAAP,CAAW,OAAX,EAAoBL,IAAIH,GAAJ,CAAQ,OAAR,MAAqBF,IAAIE,GAAJ,CAAQ,OAAR,CAAzC;AACH;;AAED,mBAAOI,MAAP;AACH,SAbD,CADgB,EAcZ,IAdY,CAApB;;AAgBA,cAAKZ,SAAL,CAAeF,IAAf,CAAoB,IAAIG,cAAJ,CAAa,GAAb,EAAkB,CAAC,IAAIF,cAAJ,CAAW,KAAX,EAAkBN,aAAMG,MAAxB,CAAD,CAAlB,EAAqDH,aAAMC,MAA3D,EAChB,IAAIQ,kCAAJ,CAAqB,UAACC,OAAD,EAAa;AAC9B,gBAAIc,OAAO,IAAIC,0BAAJ,CAAiB,IAAIC,oBAAJ,CAAc,KAAd,CAAjB,EAAuC,UAAvC,EAAmD,EAAnD,CAAX;;AAEA,gBAAIb,MAAMc,qBAAUC,QAAV,CAAmBlB,OAAnB,EAA4Bc,IAA5B,CAAV;AACA,gBAAIN,MAAMR,QAAQC,IAAlB;;AAEA,gBAAIkB,QAAQT,YAAIC,MAAJ,CAAWX,OAAX,EAAoBV,aAAMC,MAA1B,CAAZ;;AAEA4B,kBAAMN,GAAN,CAAU,OAAV,EAAmBL,IAAIH,GAAJ,CAAQ,OAAR,IAAmBF,IAAIE,GAAJ,CAAQ,OAAR,CAAtC;;AAEA,mBAAOc,KAAP;AACH,SAXD,CADgB,CAApB;;AAcA,cAAKtB,SAAL,CAAeF,IAAf,CAAoB,IAAIG,cAAJ,CAAa,IAAb,EAAmB,CAAC,IAAIF,cAAJ,CAAW,OAAX,EAAoBN,aAAM8B,GAA1B,CAAD,CAAnB,EAAqD9B,aAAMC,MAA3D,EAChB,IAAIQ,kCAAJ,CAAqB,UAACC,OAAD,EAAa;AAC9B,gBAAIqB,QAAQrB,QAAQI,KAAR,CAAcC,GAAd,CAAkBL,QAAQM,WAAR,CAAoBC,IAApB,CAAyB,OAAzB,CAAlB,CAAZ;AACA,gBAAIN,OAAOD,QAAQC,IAAnB;;AAEA,gBAAIkB,QAAQT,YAAIC,MAAJ,CAAWX,OAAX,EAAoBV,aAAMC,MAA1B,CAAZ;;AAEA4B,kBAAMN,GAAN,CAAU,OAAV,EAAmBZ,KAAKI,GAAL,CAAS,OAAT,EAAkBiB,MAAlB,CAAyBD,MAAMhB,GAAN,CAAU,OAAV,CAAzB,CAAnB;;AAEA,mBAAOc,KAAP;AACH,SATD,CADgB,CAApB;;AAYA,cAAKtB,SAAL,CAAeF,IAAf,CAAoB,IAAIG,cAAJ,CAAa,QAAb,EAAuB,EAAvB,EAA2BR,aAAM8B,GAAjC,EAChB,IAAIrB,kCAAJ,CAAqB,UAACC,OAAD,EAAa;AAC9B,gBAAImB,QAAQT,YAAIC,MAAJ,CAAWX,OAAX,EAAoBV,aAAM8B,GAA1B,CAAZ;;AAEAD,kBAAMN,GAAN,CAAU,OAAV,EAAmBb,QAAQC,IAAR,CAAaI,GAAb,CAAiB,OAAjB,EAA0BkB,MAA7C;;AAEA,mBAAOJ,KAAP;AACH,SAND,CADgB,CAApB;;AASA,cAAKtB,SAAL,CAAeF,IAAf,CAAoB,IAAIG,cAAJ,CAAa,UAAb,EAAyB,CAAC,IAAIF,cAAJ,CAAW,GAAX,EAAgBN,aAAMC,MAAtB,CAAD,CAAzB,EAA0DD,aAAMY,IAAhE,EAChB,IAAIH,kCAAJ,CAAqB,UAACC,OAAD,EAAa;AAC9B,gBAAIwB,IAAIxB,QAAQI,KAAR,CAAcC,GAAd,CAAkBL,QAAQM,WAAR,CAAoBC,IAApB,CAAyB,GAAzB,CAAlB,CAAR;AACA,gBAAIN,OAAOD,QAAQC,IAAnB;;AAEA,gBAAIkB,QAAQT,YAAIC,MAAJ,CAAWX,OAAX,EAAoBV,aAAMY,IAA1B,CAAZ;;AAEAiB,kBAAMN,GAAN,CAAU,OAAV,EAAmBZ,KAAKI,GAAL,CAAS,OAAT,EAAkBoB,MAAlB,CAAyBD,EAAEnB,GAAF,CAAM,OAAN,CAAzB,IAA2C,CAA9D;;AAEA,mBAAOc,KAAP;AACH,SATD,CADgB,CAApB;;AAYA,cAAKtB,SAAL,CAAeF,IAAf,CAAoB,IAAIG,cAAJ,CAAa,YAAb,EAA2B,CAAC,IAAIF,cAAJ,CAAW,GAAX,EAAgBN,aAAMC,MAAtB,CAAD,CAA3B,EAA4DD,aAAMY,IAAlE,EAChB,IAAIH,kCAAJ,CAAqB,UAACC,OAAD,EAAa;AAC9B,gBAAIwB,IAAIxB,QAAQI,KAAR,CAAcC,GAAd,CAAkBL,QAAQM,WAAR,CAAoBC,IAApB,CAAyB,GAAzB,CAAlB,CAAR;AACA,gBAAIN,OAAOD,QAAQC,IAAnB;;AAEA,gBAAIkB,QAAQT,YAAIC,MAAJ,CAAWX,OAAX,EAAoBV,aAAMY,IAA1B,CAAZ;;AAEAiB,kBAAMN,GAAN,CAAU,OAAV,EAAmBZ,KAAKI,GAAL,CAAS,OAAT,EAAkBqB,UAAlB,CAA6BF,EAAEnB,GAAF,CAAM,OAAN,CAA7B,CAAnB;;AAEA,mBAAOc,KAAP;AACH,SATD,CADgB,CAApB;;AAYA,cAAKtB,SAAL,CAAeF,IAAf,CAAoB,IAAIG,cAAJ,CAAa,UAAb,EAAyB,CAAC,IAAIF,cAAJ,CAAW,GAAX,EAAgBN,aAAMC,MAAtB,CAAD,CAAzB,EAA0DD,aAAMY,IAAhE,EAChB,IAAIH,kCAAJ,CAAqB,UAACC,OAAD,EAAa;AAC9B,gBAAIwB,IAAIxB,QAAQI,KAAR,CAAcC,GAAd,CAAkBL,QAAQM,WAAR,CAAoBC,IAApB,CAAyB,GAAzB,CAAlB,CAAR;AACA,gBAAIN,OAAOD,QAAQC,IAAnB;;AAEA,gBAAIkB,QAAQT,YAAIC,MAAJ,CAAWX,OAAX,EAAoBV,aAAMY,IAA1B,CAAZ;;AAEAiB,kBAAMN,GAAN,CAAU,OAAV,EAAmBZ,KAAKI,GAAL,CAAS,OAAT,EAAkBsB,QAAlB,CAA2BH,EAAEnB,GAAF,CAAM,OAAN,CAA3B,CAAnB;;AAEA,mBAAOc,KAAP;AACH,SATD,CADgB,CAApB;;AAYA,cAAKtB,SAAL,CAAeF,IAAf,CAAoB,IAAIG,cAAJ,CAAa,SAAb,EAAwB,CAAC,IAAIF,cAAJ,CAAW,GAAX,EAAgBN,aAAMC,MAAtB,CAAD,CAAxB,EAAyDD,aAAM8B,GAA/D,EAChB,IAAIrB,kCAAJ,CAAqB,UAACC,OAAD,EAAa;AAC9B,gBAAIwB,IAAIxB,QAAQI,KAAR,CAAcC,GAAd,CAAkBL,QAAQM,WAAR,CAAoBC,IAApB,CAAyB,GAAzB,CAAlB,CAAR;AACA,gBAAIN,OAAOD,QAAQC,IAAnB;;AAEA,gBAAIkB,QAAQT,YAAIC,MAAJ,CAAWX,OAAX,EAAoBV,aAAM8B,GAA1B,CAAZ;;AAEAD,kBAAMN,GAAN,CAAU,OAAV,EAAmBZ,KAAKI,GAAL,CAAS,OAAT,EAAkBuB,OAAlB,CAA0BJ,EAAEnB,GAAF,CAAM,OAAN,CAA1B,CAAnB;;AAEA,mBAAOc,KAAP;AACH,SATD,CADgB,CAApB;;AAYA,cAAKtB,SAAL,CAAeF,IAAf,CAAoB,IAAIG,cAAJ,CAAa,SAAb,EAAwB,EAAxB,EAA4BR,aAAMC,MAAlC,EAChB,IAAIQ,kCAAJ,CAAqB,UAACC,OAAD,EAAa;AAC9B,gBAAImB,QAAQT,YAAIC,MAAJ,CAAWX,OAAX,EAAoBV,aAAMC,MAA1B,CAAZ;;AAEA4B,kBAAMN,GAAN,CAAU,OAAV,EAAmBb,QAAQC,IAAR,CAAaI,GAAb,CAAiB,OAAjB,EAA0BwB,WAA1B,EAAnB;;AAEA,mBAAOV,KAAP;AACH,SAND,CADgB,CAApB;;AASA,cAAKtB,SAAL,CAAeF,IAAf,CAAoB,IAAIG,cAAJ,CAAa,SAAb,EAAwB,EAAxB,EAA4BR,aAAMC,MAAlC,EAChB,IAAIQ,kCAAJ,CAAqB,UAACC,OAAD,EAAa;AAC9B,gBAAImB,QAAQT,YAAIC,MAAJ,CAAWX,OAAX,EAAoBV,aAAMC,MAA1B,CAAZ;;AAEA4B,kBAAMN,GAAN,CAAU,OAAV,EAAmBb,QAAQC,IAAR,CAAaI,GAAb,CAAiB,OAAjB,EAA0ByB,WAA1B,EAAnB;;AAEA,mBAAOX,KAAP;AACH,SAND,CADgB,CAApB;;AASA,cAAKtB,SAAL,CAAeF,IAAf,CAAoB,IAAIG,cAAJ,CAAa,WAAb,EAA0B,CAAC,IAAIF,cAAJ,CAAW,OAAX,EAAoBN,aAAM8B,GAA1B,CAAD,CAA1B,EAA4D9B,aAAMC,MAAlE,EAChB,IAAIQ,kCAAJ,CAAqB,UAACC,OAAD,EAAa;AAC9B,gBAAI+B,QAAQ/B,QAAQI,KAAR,CAAcC,GAAd,CAAkBL,QAAQM,WAAR,CAAoBC,IAApB,CAAyB,OAAzB,CAAlB,CAAZ;;AAEA,gBAAIY,QAAQT,YAAIC,MAAJ,CAAWX,OAAX,EAAoBV,aAAMC,MAA1B,CAAZ;;AAEA4B,kBAAMN,GAAN,CAAU,OAAV,EAAmBb,QAAQC,IAAR,CAAaI,GAAb,CAAiB,OAAjB,EAA0B2B,SAA1B,CAAoCD,MAAM1B,GAAN,CAAU,OAAV,CAApC,CAAnB;;AAEA,mBAAOc,KAAP;AACH,SARD,CADgB,CAApB;;AAWA,cAAKtB,SAAL,CAAeF,IAAf,CAAoB,IAAIG,cAAJ,CAAa,WAAb,EAA0B,CAAC,IAAIF,cAAJ,CAAW,OAAX,EAAoBN,aAAM8B,GAA1B,CAAD,EAAiC,IAAIxB,cAAJ,CAAW,KAAX,EAAkBN,aAAM8B,GAAxB,CAAjC,CAA1B,EAA0F9B,aAAMC,MAAhG,EAChB,IAAIQ,kCAAJ,CAAqB,UAACC,OAAD,EAAa;AAC9B,gBAAI+B,QAAQ/B,QAAQI,KAAR,CAAcC,GAAd,CAAkBL,QAAQM,WAAR,CAAoBC,IAApB,CAAyB,OAAzB,CAAlB,CAAZ;AACA,gBAAI0B,MAAMjC,QAAQI,KAAR,CAAcC,GAAd,CAAkBL,QAAQM,WAAR,CAAoBC,IAApB,CAAyB,KAAzB,CAAlB,CAAV;;AAEA,gBAAIY,QAAQT,YAAIC,MAAJ,CAAWX,OAAX,EAAoBV,aAAMC,MAA1B,CAAZ;;AAEA4B,kBAAMN,GAAN,CAAU,OAAV,EAAmBb,QAAQC,IAAR,CAAaI,GAAb,CAAiB,OAAjB,EAA0B2B,SAA1B,CAAoCD,MAAM1B,GAAN,CAAU,OAAV,CAApC,EAAwD4B,IAAI5B,GAAJ,CAAQ,OAAR,CAAxD,CAAnB;;AAEA,mBAAOc,KAAP;AACH,SATD,CADgB,CAApB;;AAYA,cAAKtB,SAAL,CAAeF,IAAf,CAAoB,IAAIG,cAAJ,CAAa,MAAb,EAAqB,EAArB,EAAyBR,aAAMC,MAA/B,EAChB,IAAIQ,kCAAJ,CAAqB,UAACC,OAAD,EAAa;AAC9B,gBAAImB,QAAQT,YAAIC,MAAJ,CAAWX,OAAX,EAAoBV,aAAMC,MAA1B,CAAZ;;AAEA4B,kBAAMN,GAAN,CAAU,OAAV,EAAmBb,QAAQC,IAAR,CAAaI,GAAb,CAAiB,OAAjB,EAA0B6B,IAA1B,EAAnB;;AAEA,mBAAOf,KAAP;AACH,SAND,CADgB,CAApB;;AASA,cAAKtB,SAAL,CAAeF,IAAf,CAAoB,IAAIG,cAAJ,CAAa,SAAb,EAAwB,CAAC,IAAIF,cAAJ,CAAW,QAAX,EAAqBN,aAAMC,MAA3B,CAAD,EAAqC,IAAIK,cAAJ,CAAW,QAAX,EAAqBN,aAAMC,MAA3B,CAArC,CAAxB,EAAkGD,aAAMC,MAAxG,EAChB,IAAIQ,kCAAJ,CAAqB,UAACC,OAAD,EAAa;AAC9B,gBAAImC,SAASnC,QAAQI,KAAR,CAAcC,GAAd,CAAkBL,QAAQM,WAAR,CAAoBC,IAApB,CAAyB,QAAzB,CAAlB,CAAb;AACA,gBAAI6B,SAASpC,QAAQI,KAAR,CAAcC,GAAd,CAAkBL,QAAQM,WAAR,CAAoBC,IAApB,CAAyB,QAAzB,CAAlB,CAAb;AACA,gBAAIN,OAAOD,QAAQC,IAAnB;;AAEA,gBAAIkB,QAAQT,YAAIC,MAAJ,CAAWX,OAAX,EAAoBV,aAAMC,MAA1B,CAAZ;;AAEA4B,kBAAMN,GAAN,CAAU,OAAV,EAAmBZ,KAAKI,GAAL,CAAS,OAAT,EAAkBgC,OAAlB,CAA0BF,OAAO9B,GAAP,CAAW,OAAX,CAA1B,EAA+C+B,OAAO/B,GAAP,CAAW,OAAX,CAA/C,CAAnB;;AAEA,mBAAOc,KAAP;AACH,SAVD,CADgB,CAApB;AAnKU;AA+Kb;;;EAjL4BmB,Y","file":"str.js","sourcesContent":["import { Class } from '../../ast/class'\nimport { Evaluator } from '../../interpreter/evaluator'\nimport { Formal } from '../../ast/formal'\nimport { Function } from '../../ast/func'\nimport { FunctionCall } from '../../ast/functioncall'\nimport { NativeExpression } from '../../ast/nativeexpression'\nimport { Obj } from '../../interpreter/object'\nimport { Reference } from '../../ast/reference'\nimport { Types } from '../../types/types'\n\nexport class StringClass extends Class {\n\n    constructor() {\n        super();\n\n        this.name = Types.String;\n\n        this.superClass = Types.Object;\n\n        this.properties.push(new Formal('value', 'string'));\n\n        this.functions.push(new Function('toString', [], Types.String,\n            new NativeExpression((context) => {\n                return context.self;\n            }), true));\n\n        this.functions.push(new Function('==', [new Formal('rhs', Types.Object)], Types.Bool,\n            new NativeExpression((context) => {\n                let rhs = context.store.get(context.environment.find('rhs'));\n                let lhs = context.self;\n\n                let result = Obj.create(context, Types.Bool);\n\n                if (rhs.type !== Types.String) {\n                    result.set('value', false);\n                } else {\n                    result.set('value', lhs.get('value') === rhs.get('value'));\n                }\n\n                return result;\n            }), true));\n\n        this.functions.push(new Function('+', [new Formal('rhs', Types.Object)], Types.String,\n            new NativeExpression((context) => {\n                let call = new FunctionCall(new Reference('rhs'), 'toString', []);\n\n                let rhs = Evaluator.evaluate(context, call);\n                let lhs = context.self;\n\n                let value = Obj.create(context, Types.String);\n\n                value.set('value', lhs.get('value') + rhs.get('value'));\n\n                return value;\n            })));\n\n        this.functions.push(new Function('at', [new Formal('index', Types.Int)], Types.String,\n            new NativeExpression((context) => {\n                let index = context.store.get(context.environment.find('index'));\n                let self = context.self;\n\n                let value = Obj.create(context, Types.String);\n\n                value.set('value', self.get('value').charAt(index.get('value')));\n\n                return value;\n            })));\n\n        this.functions.push(new Function('length', [], Types.Int,\n            new NativeExpression((context) => {\n                let value = Obj.create(context, Types.Int);\n\n                value.set('value', context.self.get('value').length);\n\n                return value;\n            })));\n\n        this.functions.push(new Function('contains', [new Formal('s', Types.String)], Types.Bool,\n            new NativeExpression((context) => {\n                let s = context.store.get(context.environment.find('s'));\n                let self = context.self;\n\n                let value = Obj.create(context, Types.Bool);\n\n                value.set('value', self.get('value').search(s.get('value')) > 0);\n\n                return value;\n            })));\n\n        this.functions.push(new Function('startsWith', [new Formal('s', Types.String)], Types.Bool,\n            new NativeExpression((context) => {\n                let s = context.store.get(context.environment.find('s'));\n                let self = context.self;\n\n                let value = Obj.create(context, Types.Bool);\n\n                value.set('value', self.get('value').startsWith(s.get('value')));\n\n                return value;\n            })));\n\n        this.functions.push(new Function('endsWith', [new Formal('s', Types.String)], Types.Bool,\n            new NativeExpression((context) => {\n                let s = context.store.get(context.environment.find('s'));\n                let self = context.self;\n\n                let value = Obj.create(context, Types.Bool);\n\n                value.set('value', self.get('value').endsWith(s.get('value')));\n\n                return value;\n            })));\n\n        this.functions.push(new Function('indexOf', [new Formal('s', Types.String)], Types.Int,\n            new NativeExpression((context) => {\n                let s = context.store.get(context.environment.find('s'));\n                let self = context.self;\n\n                let value = Obj.create(context, Types.Int);\n\n                value.set('value', self.get('value').indexOf(s.get('value')));\n\n                return value;\n            })));\n\n        this.functions.push(new Function('toUpper', [], Types.String,\n            new NativeExpression((context) => {\n                let value = Obj.create(context, Types.String);\n\n                value.set('value', context.self.get('value').toUpperCase());\n\n                return value;\n            })));\n\n        this.functions.push(new Function('toLower', [], Types.String,\n            new NativeExpression((context) => {\n                let value = Obj.create(context, Types.String);\n\n                value.set('value', context.self.get('value').toLowerCase());\n\n                return value;\n            })));\n\n        this.functions.push(new Function('substring', [new Formal('start', Types.Int)], Types.String,\n            new NativeExpression((context) => {\n                let start = context.store.get(context.environment.find('start'));\n\n                let value = Obj.create(context, Types.String);\n\n                value.set('value', context.self.get('value').substring(start.get('value')));\n\n                return value;\n            })));\n\n        this.functions.push(new Function('substring', [new Formal('start', Types.Int), new Formal('end', Types.Int)], Types.String,\n            new NativeExpression((context) => {\n                let start = context.store.get(context.environment.find('start'));\n                let end = context.store.get(context.environment.find('end'));\n\n                let value = Obj.create(context, Types.String);\n\n                value.set('value', context.self.get('value').substring(start.get('value'), end.get('value')));\n\n                return value;\n            })));\n\n        this.functions.push(new Function('trim', [], Types.String,\n            new NativeExpression((context) => {\n                let value = Obj.create(context, Types.String);\n\n                value.set('value', context.self.get('value').trim());\n\n                return value;\n            })));\n\n        this.functions.push(new Function('replace', [new Formal('oldSub', Types.String), new Formal('newSub', Types.String)], Types.String,\n            new NativeExpression((context) => {\n                let oldSub = context.store.get(context.environment.find('oldSub'));\n                let newSub = context.store.get(context.environment.find('newSub'));\n                let self = context.self;\n\n                let value = Obj.create(context, Types.String);\n\n                value.set('value', self.get('value').replace(oldSub.get('value'), newSub.get('value')));\n\n                return value;\n            })));\n    }\n}"]}